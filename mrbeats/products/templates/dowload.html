{% extends 'layouts/base.html' %}
{% load static %}
{% block content %}
<div class="min-h-screen bg-[#0b0b0b] text-gray-200 py-12 px-6">
  <div class="max-w-6xl mx-auto">
    <h1 class="text-5xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-blue-400 mb-2">
      My Downloads
    </h1>
    <p class="text-gray-400 mb-8">Access all your purchased beats and music files</p>
    {% for i in data %}
    <div>
      <div
        class="flex flex-col md:flex-row items-center justify-between bg-gray-900/60 border border-purple-900/20 rounded-2xl p-6 mb-6">
        <div class="flex items-start gap-5 w-full md:w-2/3">
          <img src="{{i.product.product_image.url}}" alt="Midnight Vibes"
            class="w-28 h-28 rounded-lg object-cover border border-gray-700">
          <div>
            <h2 class="text-2xl font-semibold text-white">{{i.product.title}}</h2>
            <p class="text-sm text-gray-400 mt-1">By <span class="font-bold">{{i.seller.username}}</span></p>
            <p class="text-sm text-gray-500 mt-2">Purchased on {{i.order.created_at}}</p>
            <div class="flex gap-2 mt-2">
              <form action="{% url 'dowload' %}" method="POST">
                {% csrf_token %}
                <input type="text" class="hidden" value="{{i.product.id}}" name="item_id">
                <input type="text" class="hidden" value="{{user_id}}" name="user_id">
                <button type="submit"
                  class="bg-gray-800 hover:bg-gray-700 text-sm px-3 py-1 rounded-lg flex items-center gap-2">⬇ Download</button>
              </form>
            </div>
          </div>
        </div>
        <div class="bg-gray-800 p-4 rounded-2xl shadow-xl text-center">
          <h2 class="text-xl font-semibold mb-4">How would you rate this beats/lyrics?</h2>

          <form action="{% url 'review' %}" method="POST">
            {% csrf_token %}

            <div class="flex justify-center space-x-3">
              {% for j in "12345" %}
              <label>
                <input type="radio" name="score" value="{{ j }}" class="hidden peer" required>
                <input type="number" name="product_id" value="{{ i.product.id }}" class="hidden" required>
                <span class="text-3xl cursor-pointer text-gray-400 peer-checked:text-yellow-400">{{j}}★</span>
              </label>
              {% endfor %}
            </div>
            <textarea name="comment" rows="2" placeholder="review our product..." class="mt-2 w-full text-sm p-2 rounded-md bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-400 resize-none"></textarea>

            <button type="submit"
              class="mt-5 bg-yellow-500 hover:bg-yellow-600 text-white px-5 py-2 rounded-xl font-semibold transition">
              Rating
            </button>
          </form>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}