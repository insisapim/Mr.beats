{% extends 'layouts/base.html' %} {%block title%}Mr.Beats-EditProfile{%endblock%}
 {% block content %}
<div class="max-w-2xl mx-auto bg-gray-800 rounded-xl p-6 text-gray-100">
  <h2 class="text-2xl font-bold mb-6">Edit Profile</h2>

  <form method="POST" enctype="multipart/form-data" class="space-y-4">
    {% csrf_token %}

    <!-- Artist Name -->
    <div>
      <label for="id_artist_name" class="block text-sm font-medium mb-1"
        >Artist Name</label
      >
      {{ form.artist_name }} {% if form.artist_name.errors %}
      <p class="text-red-500 text-sm mt-1">{{ form.artist_name.errors.0 }}</p>
      {% endif %}
    </div>

    <!-- Bio -->
    <div>
      <label for="id_bio" class="block text-sm font-medium mb-1">Bio</label>
      {{ form.bio}} {% if form.bio.errors %}
      <p class="text-red-500 text-sm mt-1">{{ form.bio.errors.0 }}</p>
      {% endif %}
    </div>

    <!-- Profile Image -->
    <div>
      <label class="block mb-2 font-semibold mt-6">Profile Image</label>
      <div
        class="relative border-2 border-dashed border-gray-600 rounded-lg p-12 text-center cursor-pointer hover:border-purple-500 flex flex-col items-center justify-center"
      >
        {{ form.profile_image}}
        
        {% if user.profile_image %}
      <img
        id="profilePreview"
        src="{{ user.profile_image.url }}"
        class="mt-4 max-h-48 rounded-lg border border-gray-700"
        alt="Current Profile Image"
      />
    {% else %}
      <img
        id="profilePreview"
        class="mt-4 max-h-48 rounded-lg hidden border border-gray-700"
        alt="Profile Preview"
      />
    {% endif %}
    
        <label
          for="{{ form.profile_image.id_for_label }}"
          class="cursor-pointer flex flex-col items-center"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            class="w-12 h-12 text-white mb-4"
            viewBox="0 0 16 16"
          >
            <path d="M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0" />
            <path
              d="M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1z"
            />
          </svg>
          Upload Your Profile Image (JPG, PNG)
        </label>
      </div>

      
    </div>

    <!-- Submit -->
    <div class="pt-4">
      <button
        type="submit"
        class="bg-purple-600 hover:bg-purple-500 px-6 py-2 rounded text-white font-medium"
      >
        Save Changes
      </button>
    </div>
  </form>
</div>
<script>
  const coverInput = document.getElementById(
    "{{ form.profile_image.id_for_label }}"
  );
  const coverPreview = document.getElementById("profilePreview");

  coverInput?.addEventListener("change", (e) => {
    const file = e.target.files[0];
    console.log(file)
    if (file && file.type.startsWith("image/")) {
      const reader = new FileReader();
      reader.onload = (ev) => {
        coverPreview.src = ev.target.result;
        coverPreview.classList.remove("hidden");
      };
      reader.readAsDataURL(file);
    } else {
      coverPreview.classList.add("hidden");
      coverPreview.src = "";
    }
  });
</script>
{% endblock %}
